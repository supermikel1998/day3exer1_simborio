"use strict";

sap.ui.define(["sap/ui/dt/OverlayUtil", "../../../cpe/quick-actions/utils", "../../../utils/core", "../../dialog-factory", "../dialog-enablement-validator", "./table-quick-action-base", "../control-types"], function (OverlayUtil, _____cpe_quick_actions_utils, _____utils_core, ____dialog_factory, ___dialog_enablement_validator, ___table_quick_action_base, ___control_types) {
  "use strict";

  const getRelevantControlFromActivePage = _____cpe_quick_actions_utils["getRelevantControlFromActivePage"];
  const getControlById = _____utils_core["getControlById"];
  const DialogFactory = ____dialog_factory["DialogFactory"];
  const DialogNames = ____dialog_factory["DialogNames"];
  const DIALOG_ENABLEMENT_VALIDATOR = ___dialog_enablement_validator["DIALOG_ENABLEMENT_VALIDATOR"];
  const TableQuickActionDefinitionBase = ___table_quick_action_base["TableQuickActionDefinitionBase"];
  const MDC_TABLE_TYPE = ___control_types["MDC_TABLE_TYPE"];
  const CREATE_TABLE_ACTION = 'create_table_action';
  const TOOLBAR_ACTION = 'sap.ui.mdc.ActionToolbar';

  /**
   * Quick Action for creating table action.
   */
  class AddTableActionQuickAction extends TableQuickActionDefinitionBase {
    constructor(context) {
      super(CREATE_TABLE_ACTION, [MDC_TABLE_TYPE], 'QUICK_ACTION_ADD_CUSTOM_TABLE_ACTION', context, true, [DIALOG_ENABLEMENT_VALIDATOR]);
    }
    async execute(path) {
      const index = this.tableMap[path];
      const smartTablesToolbarAction = getRelevantControlFromActivePage(this.context.controlIndex, this.context.view, [TOOLBAR_ACTION]);
      for (let i = 0; i < smartTablesToolbarAction.length; i++) {
        if (i === index) {
          const section = getControlById(smartTablesToolbarAction[i].getId());
          const controlOverlay = OverlayUtil.getClosestOverlayFor(section);
          if (controlOverlay) {
            controlOverlay.setSelected(true);
            await DialogFactory.createDialog(controlOverlay, this.context.rta, DialogNames.ADD_FRAGMENT, undefined, {
              aggregation: 'actions',
              title: 'QUICK_ACTION_ADD_CUSTOM_TABLE_ACTION'
            });
          }
        }
      }
      return [];
    }
  }
  var __exports = {
    __esModule: true
  };
  __exports.CREATE_TABLE_ACTION = CREATE_TABLE_ACTION;
  __exports.AddTableActionQuickAction = AddTableActionQuickAction;
  return __exports;
});
//# sourceMappingURL=create-table-action.js.map