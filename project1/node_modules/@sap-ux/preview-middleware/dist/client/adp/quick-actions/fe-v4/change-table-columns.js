"use strict";

sap.ui.define(["sap/ui/dt/OverlayUtil", "sap/ui/fl/apply/api/FlexRuntimeInfoAPI", "../../../cpe/quick-actions/utils", "../../../utils/core", "./table-quick-action-base", "../control-types", "../dialog-enablement-validator"], function (OverlayUtil, FlexRuntimeInfoAPI, _____cpe_quick_actions_utils, _____utils_core, ___table_quick_action_base, ___control_types, ___dialog_enablement_validator) {
  "use strict";

  const getRelevantControlFromActivePage = _____cpe_quick_actions_utils["getRelevantControlFromActivePage"];
  const getControlById = _____utils_core["getControlById"];
  const TableQuickActionDefinitionBase = ___table_quick_action_base["TableQuickActionDefinitionBase"];
  const MDC_TABLE_TYPE = ___control_types["MDC_TABLE_TYPE"];
  const DIALOG_ENABLEMENT_VALIDATOR = ___dialog_enablement_validator["DIALOG_ENABLEMENT_VALIDATOR"];
  const CHANGE_TABLE_COLUMNS = 'change-table-columns';
  const ACTION_ID = 'CTX_SETTINGS0';
  const CONTROL_TYPE = 'sap.ui.mdc.Table';

  /**
   * Quick Action for changing table columns.
   */
  class ChangeTableColumnsQuickAction extends TableQuickActionDefinitionBase {
    constructor(context) {
      super(CHANGE_TABLE_COLUMNS, [MDC_TABLE_TYPE], 'V4_QUICK_ACTION_CHANGE_TABLE_COLUMNS', context, undefined, [DIALOG_ENABLEMENT_VALIDATOR]);
    }
    async execute(path) {
      const index = this.tableMap[path];
      const smartTables = getRelevantControlFromActivePage(this.context.controlIndex, this.context.view, [CONTROL_TYPE]);
      for (let i = 0; i < smartTables.length; i++) {
        if (i === index) {
          const section = getControlById(smartTables[i].getId());
          const controlOverlay = OverlayUtil.getClosestOverlayFor(section);
          if (controlOverlay) {
            controlOverlay.setSelected(true);
          }
          const hasVariantManagement = FlexRuntimeInfoAPI.hasVariantManagement({
            element: smartTables[i]
          });
          if (!hasVariantManagement) {
            continue;
          }
          await this.context.actionService.execute(smartTables[i].getId(), ACTION_ID);
        }
      }
      return [];
    }
  }
  var __exports = {
    __esModule: true
  };
  __exports.CHANGE_TABLE_COLUMNS = CHANGE_TABLE_COLUMNS;
  __exports.ChangeTableColumnsQuickAction = ChangeTableColumnsQuickAction;
  return __exports;
});
//# sourceMappingURL=change-table-columns.js.map